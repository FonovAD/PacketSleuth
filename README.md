# PacketSleuth

### Система мониторинга сетевой активности и анализа трафика

**Описание проекта:** Этот проект представляет собой инструмент для мониторинга сетевой активности и анализа трафика в реальном времени. Основная задача системы — перехват сетевых пакетов, их анализ и предоставление пользователю информации о сетевых соединениях, типах трафика и активности на сети. Программа будет полезна для системных администраторов, которые хотят отслеживать аномалии в сетевом трафике, или для тестирования сетевой безопасности.

### Функциональные возможности:

1. **Перехват и анализ сетевых пакетов:**
    - Использование библиотеки для работы с сетевыми пакетами, например, `gopacket` (Go binding для pcap), чтобы улавливать входящие и исходящие пакеты на сетевом интерфейсе.
    - Возможность фильтрации пакетов по IP-адресу, порту, протоколу и другим параметрам.
    - Анализ структуры пакетов для определения протоколов (TCP, UDP, ICMP, HTTP, DNS и т.д.).
2. **Сбор метрик сетевой активности:**
    - Сбор информации о каждом соединении: исходящий/входящий IP-адрес, порт, размер пакетов, длительность сессии и количество переданных данных.
    - Определение пиков сетевой активности (например, анализ загрузки трафика по времени).
    - Отслеживание общего объёма трафика, пересылаемого через интерфейсы (напр., для мониторинга загрузки сети).
3. **Веб-интерфейс или CLI для визуализации:**
    - **Веб-интерфейс:** Реализация пользовательского интерфейса, где можно просматривать активные соединения, историю трафика и отчеты по анализу. Можно использовать такие библиотеки как `Gin` для создания REST API и `Vue.js` или `React` для фронтенда.
    - **CLI:** Возможность запуска программы из командной строки с выводом основных метрик в терминал, с поддержкой фильтрации и сортировки по IP-адресам, портам и типам трафика.
4. **Логирование и хранение данных:**
    - Сохранение логов трафика в базу данных (например, PostgreSQL или MySQL) для последующего анализа.
    - Логирование метрик о сетевой активности для создания отчётов и анализа тенденций.
    - Возможность экспорта данных в формате CSV или JSON для внешнего анализа.
5. **Оповещения и алертинг:**
    - Настройка оповещений в случае обнаружения аномалий в сетевом трафике (например, высокие объемы входящего трафика на определённый порт или подозрительные IP-адреса).
    - Интеграция с системами уведомлений (например, отправка сообщений в Slack, Telegram или по email).
    - Поддержка настройки пороговых значений для автоматической реакции на аномалии (например, большое количество TCP SYN-запросов может сигнализировать о DDoS-атаке).
6. **Отчеты и визуализация данных:**
    - Генерация отчётов по активности в сети за определённый период (например, топ 10 IP-адресов по количеству переданного трафика).
    - Визуализация сетевой активности в виде графиков и диаграмм (можно использовать `Grafana` для визуализации данных).
    - Возможность создания кастомных отчётов для анализа определённых протоколов или IP-адресов.

### Технические детали и стек технологий:

1. **Язык программирования:**
    
    - **Go:** Используйте Go в качестве основного языка программирования благодаря его высокой производительности и удобству работы с сетью.
2. **Библиотеки и инструменты:**
    
    - **gopacket:** Go-библиотека для работы с сетевыми пакетами. Она позволяет захватывать и анализировать пакеты на сетевом интерфейсе.
    - **pcap:** Для низкоуровневого захвата сетевого трафика (можно использовать libpcap или tcpdump на серверной стороне).
    - **Prometheus:** Для сбора и хранения метрик сетевой активности (если вам нужен масштабируемый способ мониторинга).
    - **Grafana:** Для визуализации данных в виде графиков и дашбордов.
3. **База данных:**
    
    - **PostgreSQL/MySQL:** Для хранения логов сетевого трафика, метрик и исторических данных.
    - **SQLite:** Как альтернатива для локальной установки (например, в небольших инсталляциях).
4. **Веб-фреймворк:**
    
    - **Gin:** Для создания REST API и сервиса, который будет предоставлять данные о текущих соединениях и метриках через HTTP.
    - **Vue.js/React.js:** Для фронтенда и создания удобного интерфейса пользователя.
5. **Фильтрация трафика:**
    
    - Использование BPF (Berkeley Packet Filter) для эффективной фильтрации пакетов при захвате (например, фильтровать по портам, IP или типам пакетов).
6. **Шифрование:**
    
    - Поддержка шифрования трафика и метрик, особенно если приложение будет использоваться в критических средах (например, передача данных между агентами и центральным сервером).

### План реализации:

1. **Этап 1: Захват и базовый анализ пакетов**
    - Настройка захвата сетевого трафика с помощью `gopacket`.
    - Анализ и фильтрация пакетов (определение протоколов и основных метаданных: IP, порт, протокол).
2. **Этап 2: Сбор и хранение метрик**
    - Добавление возможности сбора и хранения метрик (количество пакетов, объём трафика, активные IP и порты).
    - Логирование данных в базу данных.
3. **Этап 3: Визуализация и отчеты**
    - Разработка веб-интерфейса или CLI для отображения текущей сетевой активности и истории.
    - Визуализация данных с использованием графиков и таблиц.
4. **Этап 4: Настройка алертинга и уведомлений**
    - Реализация системы оповещений при обнаружении аномалий.
    - Настройка порогов для создания триггеров (например, слишком высокий трафик на определённый порт).
5. **Этап 5: Оптимизация и масштабирование**
    - Добавление поддержки мониторинга на нескольких серверах (например, распределённые агенты).
    - Оптимизация производительности для обработки больших объёмов трафика.

### Расширенные возможности:

1. **Поддержка нескольких интерфейсов:**
    - Возможность мониторинга нескольких сетевых интерфейсов одновременно.
2. **Deep Packet Inspection (DPI):**
    - Внедрение глубокого анализа содержимого пакетов для детального изучения трафика (например, анализ HTTP-запросов, HTTPS, DNS и т.д.).
3. **Поддержка pcap-файлов:**
    - Возможность загружать и анализировать уже существующие pcap-файлы (например, от tcpdump) для оффлайн-анализа.
4. **Интеграция с SIEM-системами:**
    - Возможность интеграции с существующими системами информационной безопасности и управления событиями (SIEM) для повышения уровня мониторинга безопасности сети.

### Практическое применение:

- Отслеживание и анализ сетевого трафика в корпоративной сети.
- Обнаружение аномальной активности и потенциальных атак.
- Мониторинг использования ресурсов сети для оптимизации пропускной способности.
- Углублённый анализ сетевых взаимодействий для целей безопасности.
